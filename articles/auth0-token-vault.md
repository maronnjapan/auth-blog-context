---
title: "Auth0のToken VaultをAI Agentの文脈から独立して使ってみて、ユースケースを考えてみる"
emoji: "📑"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["Auth0", "Token Vault"] # トピックは複数指定可能
published: false
targetCategories: ["security"] # カテゴリーは複数指定可能
---

- はじめに
- Token Vaultとは
    - Token Vaultはトークン専用のシークレットストアである。
    - ただし、単なるシークレットストアではなく、Token Exchange機能を持ったストアとみなせる。
    - Auth0で認証したユーザーのアクセストークンを起点として、必要な外部トークンをAuth0が自動で変換した上で提供してくれる。
    - 変換をするために都度再認証は必要なく、一度連携を行えばよい。
    - この記載は明らかな誤りではないとおもうが、正確であることを心がけてはいない。
    - なので、必ずドキュメントは参照すること。
- Token Vaultのユースケース
    - 基本的に外部プロバイダーのAPIを叩いて、かつAuth0で認証しているアプリなら使用すべきものだという認識がある。
    - 上記のケースで最近一番あるのは、AIエージェントだと思う。
        - 故に、Auth0はAI Agentの機能と合わせて動かせるドキュメントを提供をしているのだと思う。
        - AIエージェントは自律的に動くことを期待するので、外部APIを叩く際に都度認証を聞かれるのは煩わしい。
        - Token Vaultを用いれば、一度連携をしてしまえば内部で使用するリフレッシュトークンさえ生きていれば、自動的にトークンの交換を行ってくれる。
        - なので、AIエージェントの実行に人間の操作を減らしつつ、セキュリティの担保をすることができる。
- Token Vaultを触った所感
    - Cross App Accessの簡易版という印象
        - Cross App Accessにおけるトークンの交換をIdP起因で行うという部分の思想は似ている
        - また、必要なトークンの取得処理をシステムでやってくれるという意味でも似ている。
        - AIエージェントといった、システム間での通信が多くなるアプリが提供されている、昨今の状況への対応をしていると感じる。
        - ただ、実行するサービスに合わせて権限を絞りつつトークンを交換するのはできなさそう。
        - そういう意味で、Cross App Accessと思想が似ている部分はあるが、Cross App Accessとかなり類似していると考えるのは危険。
        - まあ、そもそもドキュメントでToken Vaultは OAuth 2.0 Token Exchange (RFC 8693)をベースにしているといっているので、Cross App Accessと比べること自体がお門違いではある。
            - https://auth0.com/ai/docs/intro/token-vault#what-is-token-vault
    - 認証の代わりではない。
        - Token Vaultを触ると、Googleアカウントとの連携をする。
        - また、フローを見るとAuthorization Code Flowに似ている部分もある
        - なので、認証の代わりもできるかなと感じたが実際は別物。
        - 実際、Token Vaultの設定をするにはAuth0のアクセストークンが必要なので、認証を肩代わりするのは無理なのだが。